(ns aoc.day4
  [:require [clojure.string :as str]])

(def input "57-93,9-57\n55-55,55-83\n55-88,78-88\n24-24,24-95\n7-92,8-93\n25-84,84-85\n62-85,62-85\n66-78,65-76\n28-32,31-33\n24-81,2-25\n45-80,79-80\n75-99,75-91\n24-49,23-24\n22-69,49-69\n15-77,76-78\n25-50,21-50\n29-77,29-64\n47-93,46-48\n37-42,70-97\n5-95,4-6\n37-90,74-95\n17-48,18-85\n2-97,1-89\n2-48,1-48\n52-70,42-71\n17-90,90-94\n76-77,2-76\n10-89,10-96\n40-52,39-53\n9-97,8-96\n6-74,5-6\n3-89,2-89\n35-63,62-79\n13-39,18-39\n45-81,4-46\n8-76,39-67\n3-76,1-4\n1-96,1-1\n11-59,58-60\n41-53,25-42\n5-54,11-93\n15-91,95-95\n62-62,2-63\n11-41,40-42\n52-98,51-53\n29-52,47-51\n15-86,16-86\n13-98,28-99\n8-13,14-54\n47-61,64-95\n27-95,10-76\n9-27,10-10\n23-89,24-24\n98-98,15-99\n8-92,92-96\n2-38,27-87\n22-64,20-63\n1-6,5-66\n23-49,9-48\n63-64,35-63\n6-7,7-81\n23-91,22-92\n32-97,33-69\n21-24,20-25\n35-42,34-43\n82-82,15-83\n23-34,20-34\n37-92,37-86\n35-94,30-36\n48-52,51-53\n7-74,3-73\n41-43,42-86\n2-5,5-91\n98-99,8-98\n68-86,67-67\n37-54,36-37\n3-95,2-96\n50-79,25-78\n12-71,11-72\n91-92,74-91\n10-43,9-44\n30-93,2-91\n20-44,20-54\n36-84,35-85\n75-76,75-75\n54-54,18-55\n36-91,14-39\n8-25,8-25\n16-97,4-96\n7-83,2-8\n4-4,4-71\n1-98,1-98\n87-87,33-88\n22-88,21-88\n8-94,9-89\n99-99,5-96\n63-92,63-92\n42-68,10-69\n18-96,19-19\n16-90,16-90\n9-93,8-94\n48-88,87-89\n3-68,67-98\n72-93,97-98\n11-99,11-99\n3-99,2-99\n83-87,79-86\n14-14,5-14\n1-2,1-92\n9-90,91-94\n53-85,84-84\n11-89,3-11\n13-33,32-86\n40-74,74-91\n68-71,69-86\n17-51,18-51\n47-90,47-90\n2-3,3-85\n7-97,8-75\n21-29,28-75\n87-93,53-93\n49-74,27-95\n56-65,55-97\n14-16,15-81\n7-7,8-71\n24-26,23-82\n34-56,50-55\n10-97,11-96\n52-70,16-69\n20-56,20-21\n27-96,96-97\n23-98,15-24\n24-72,86-98\n44-77,60-88\n6-98,5-99\n1-96,99-99\n8-95,99-99\n10-81,4-62\n88-88,69-89\n30-67,29-68\n14-96,15-96\n58-86,73-86\n7-55,14-54\n3-97,62-98\n11-86,9-87\n41-79,16-41\n2-99,1-96\n7-56,5-7\n25-61,24-62\n25-83,26-82\n20-82,7-12\n36-58,41-58\n98-98,16-89\n98-99,86-99\n18-50,18-93\n44-67,40-48\n46-90,47-91\n21-49,48-66\n2-90,89-94\n12-25,13-25\n5-9,6-44\n68-75,70-76\n25-99,26-99\n95-95,17-96\n13-14,13-90\n79-99,76-77\n87-88,88-89\n77-77,6-78\n36-92,35-35\n10-11,9-9\n9-37,8-38\n80-91,81-81\n17-97,17-99\n4-19,18-71\n35-92,8-91\n30-31,22-30\n19-19,18-47\n51-79,52-55\n4-8,7-77\n3-98,3-99\n68-76,67-68\n86-86,74-93\n20-86,35-86\n8-98,7-98\n56-58,14-63\n41-47,42-47\n16-89,41-88\n21-22,22-52\n2-62,3-33\n3-83,3-3\n87-94,25-86\n80-95,95-98\n7-57,8-58\n3-24,23-23\n5-43,2-4\n32-85,86-86\n39-82,38-83\n73-87,21-79\n86-94,39-87\n87-88,4-87\n41-65,48-60\n40-70,62-70\n3-44,2-43\n3-19,19-98\n65-98,66-98\n79-84,80-83\n93-97,91-98\n21-96,21-96\n30-77,31-83\n5-82,2-5\n10-82,9-10\n84-94,47-50\n26-93,27-39\n47-95,77-90\n30-33,33-81\n45-73,46-72\n12-59,12-59\n31-60,31-59\n23-76,39-75\n66-88,80-93\n58-76,2-75\n9-56,36-55\n2-94,2-94\n75-81,72-80\n9-46,10-41\n7-93,6-6\n99-99,43-97\n33-83,33-83\n20-85,84-84\n61-76,60-94\n16-75,17-75\n16-18,17-71\n6-88,7-35\n38-79,6-38\n9-42,8-10\n18-60,86-95\n3-3,2-98\n2-99,3-99\n78-82,79-82\n34-75,23-76\n3-12,3-4\n16-95,20-95\n81-85,66-75\n8-87,15-61\n37-58,37-37\n2-87,1-86\n49-89,48-84\n56-58,57-88\n77-79,3-78\n25-92,25-98\n14-73,73-74\n15-17,1-16\n41-84,1-84\n34-64,6-63\n86-88,28-87\n2-87,2-87\n68-76,34-69\n42-78,54-83\n7-92,2-24\n2-12,1-11\n72-83,64-82\n49-93,48-92\n31-32,32-59\n4-90,4-86\n2-65,71-83\n21-88,14-78\n5-92,93-94\n1-10,2-9\n40-66,39-40\n47-77,46-46\n2-99,25-99\n37-95,37-95\n60-64,60-64\n32-51,33-51\n22-90,11-88\n13-54,12-54\n67-77,16-72\n7-37,9-90\n2-54,53-53\n5-5,6-68\n8-9,9-31\n4-39,40-61\n5-95,6-95\n1-11,11-95\n30-70,30-70\n58-58,59-97\n11-41,12-44\n2-6,1-7\n10-58,10-64\n3-95,1-3\n23-55,8-23\n37-60,52-59\n6-46,6-47\n8-45,27-53\n12-95,94-94\n43-52,43-44\n9-95,10-94\n2-9,5-26\n5-8,9-97\n2-60,3-60\n87-89,45-88\n5-9,9-90\n47-91,45-47\n39-47,27-39\n16-72,16-34\n89-90,35-89\n18-93,8-17\n4-35,9-71\n64-96,27-62\n30-68,7-30\n25-70,3-26\n41-77,40-77\n87-97,24-97\n2-97,97-98\n41-50,49-67\n49-53,50-80\n18-18,19-87\n36-39,37-40\n4-83,27-93\n28-92,29-91\n33-93,93-94\n2-94,2-94\n26-65,25-26\n5-14,15-27\n19-49,19-49\n56-56,2-55\n79-79,49-80\n79-80,55-80\n61-82,17-62\n61-63,1-62\n20-92,32-73\n57-57,5-58\n19-37,20-20\n13-75,75-76\n61-99,62-99\n19-92,19-91\n34-68,35-35\n4-76,91-99\n30-71,71-72\n51-95,28-51\n64-70,51-75\n28-90,89-91\n70-85,42-83\n2-91,5-80\n45-53,17-52\n70-80,20-69\n29-88,30-89\n5-5,5-89\n30-30,30-77\n20-71,21-40\n11-44,18-43\n6-90,6-90\n1-98,97-99\n3-98,3-98\n9-42,24-42\n75-75,73-76\n20-87,86-88\n62-86,63-91\n15-61,14-16\n46-58,45-58\n2-53,47-54\n3-89,3-35\n3-99,1-78\n50-80,9-81\n96-98,69-97\n6-78,6-78\n19-77,18-77\n17-75,18-75\n54-73,53-73\n92-97,73-85\n5-76,77-77\n43-93,18-94\n7-8,8-92\n49-87,50-88\n34-56,35-57\n25-98,24-26\n11-93,12-94\n68-99,67-67\n5-8,9-55\n8-83,4-43\n52-84,51-53\n4-96,3-71\n6-94,6-99\n19-67,18-68\n1-91,2-96\n24-35,36-54\n13-96,13-99\n19-47,32-36\n10-62,6-61\n3-4,4-98\n42-43,43-76\n17-58,54-58\n57-77,12-77\n78-99,25-77\n3-91,1-90\n13-28,29-83\n60-88,23-59\n78-95,79-95\n16-97,16-17\n14-71,12-70\n1-99,2-99\n11-84,5-11\n55-80,55-80\n28-67,68-68\n60-81,60-81\n7-74,7-74\n3-68,2-4\n5-70,6-70\n4-92,30-93\n44-79,43-99\n31-70,4-98\n2-93,1-93\n6-95,5-5\n16-36,5-36\n13-14,13-31\n53-84,54-73\n41-75,74-91\n31-90,48-91\n25-93,19-93\n9-95,6-9\n27-89,25-28\n19-86,18-73\n11-62,10-11\n73-75,23-75\n19-90,18-96\n5-5,4-51\n16-98,42-52\n11-81,12-82\n65-95,66-95\n61-61,61-82\n68-74,73-78\n31-42,1-32\n7-97,7-96\n58-59,42-58\n99-99,13-92\n63-94,20-95\n17-38,8-18\n60-71,15-52\n75-90,9-76\n14-99,13-98\n9-16,16-81\n54-83,54-90\n18-18,18-53\n16-64,15-16\n19-60,18-19\n2-90,1-91\n79-79,79-98\n32-58,31-33\n60-65,59-65\n13-34,13-34\n6-34,33-33\n59-64,58-84\n13-13,13-71\n4-76,3-82\n77-86,60-75\n63-96,52-95\n4-68,3-5\n21-45,5-21\n11-81,10-12\n1-97,96-96\n25-78,26-79\n17-38,20-48\n61-62,62-90\n16-99,16-99\n12-66,42-65\n3-85,2-84\n6-47,7-46\n3-76,4-85\n10-44,11-72\n12-47,47-48\n47-84,48-84\n43-99,24-77\n21-44,21-25\n75-85,44-84\n86-97,32-86\n24-92,23-88\n86-88,49-87\n96-96,2-79\n90-95,17-95\n11-88,10-89\n3-59,1-4\n10-56,11-83\n46-94,47-94\n3-98,98-99\n34-86,34-94\n9-17,11-16\n89-93,21-90\n15-98,15-98\n32-84,33-85\n46-46,45-80\n5-69,70-93\n8-99,9-98\n4-99,5-95\n1-35,2-67\n1-99,2-98\n11-22,14-22\n32-95,33-94\n48-77,72-77\n28-30,22-29\n35-86,36-86\n56-60,55-60\n44-75,44-59\n85-91,8-86\n21-22,21-59\n96-97,8-60\n7-50,51-85\n32-98,33-33\n11-12,11-81\n6-7,6-39\n32-68,33-69\n19-46,18-50\n45-96,45-49\n1-13,4-94\n86-87,14-87\n15-15,16-93\n29-48,28-28\n89-97,90-98\n6-59,7-60\n13-13,13-64\n21-64,81-95\n17-34,18-33\n3-87,86-90\n4-84,2-38\n40-76,39-76\n17-84,18-85\n66-96,25-65\n16-97,16-96\n64-65,4-66\n53-66,10-86\n15-78,16-77\n75-76,54-75\n4-98,20-97\n22-75,23-62\n42-89,42-89\n70-71,69-70\n18-90,19-89\n40-68,67-69\n7-73,6-7\n86-95,96-97\n40-58,39-72\n1-43,5-28\n10-60,5-49\n30-81,29-91\n7-77,8-11\n8-65,9-65\n3-57,4-11\n1-2,2-96\n56-58,41-57\n34-89,83-90\n59-97,58-98\n29-30,28-30\n54-82,31-57\n4-99,98-98\n14-36,34-39\n88-97,3-98\n16-53,17-99\n39-39,39-72\n39-61,62-80\n20-32,31-43\n49-70,50-70\n65-75,34-66\n1-99,1-2\n57-90,56-94\n28-62,33-62\n21-21,22-96\n18-65,17-88\n93-97,60-94\n74-93,92-94\n9-18,17-77\n46-89,30-45\n17-97,16-98\n2-99,98-98\n11-21,12-20\n99-99,4-96\n36-48,35-44\n70-74,63-81\n40-41,40-92\n2-94,22-93\n67-73,60-78\n29-30,22-29\n65-99,65-99\n7-20,6-21\n29-99,30-99\n40-98,86-99\n20-37,21-53\n86-86,7-87\n25-39,30-93\n55-78,56-88\n5-15,6-7\n16-17,2-16\n71-72,72-83\n9-21,8-21\n5-44,3-26\n77-77,12-84\n15-16,16-53\n44-69,43-69\n6-84,5-5\n34-77,33-77\n15-78,15-97\n28-86,15-29\n47-96,46-46\n57-59,21-58\n2-91,4-92\n11-14,13-75\n45-46,45-99\n26-57,24-26\n4-95,67-98\n15-54,15-15\n41-44,19-42\n19-20,19-98\n16-86,15-86\n13-47,46-82\n13-50,12-14\n11-98,6-89\n44-89,45-99\n7-82,82-83\n24-61,24-24\n23-60,23-59\n10-86,9-10\n74-86,73-74\n1-41,5-82\n3-4,4-84\n94-98,19-83\n2-97,93-96\n89-91,45-90\n7-12,11-94\n52-60,46-51\n3-3,2-85\n35-43,42-66\n29-92,28-92\n20-21,21-96\n91-91,90-91\n8-34,8-21\n8-95,95-96\n4-81,44-82\n2-84,1-2\n11-88,11-11\n17-69,16-70\n12-76,11-12\n13-64,66-75\n38-68,69-85\n86-86,85-91\n10-87,11-97\n10-78,36-77\n8-68,7-68\n4-87,3-87\n62-64,12-65\n32-79,33-79\n2-90,2-3\n3-8,8-26\n63-64,63-70\n25-30,7-30\n3-92,3-92\n4-98,3-99\n2-3,2-43\n43-65,43-85\n17-62,91-94\n88-90,48-89\n13-96,1-96\n44-71,44-93\n66-71,70-72\n28-63,27-62\n19-19,20-99\n23-23,24-93\n27-84,28-85\n77-82,21-78\n40-40,24-41\n88-89,6-88\n1-97,96-98\n1-88,2-42\n12-39,12-13\n47-62,61-65\n3-97,7-96\n30-66,29-67\n71-90,72-78\n98-98,6-97\n43-43,43-48\n36-99,35-95\n30-93,30-99\n5-28,6-11\n3-22,2-96\n9-87,8-71\n41-79,27-69\n6-99,7-98\n99-99,45-76\n97-99,14-96\n6-39,7-92\n5-49,13-64\n6-41,4-41\n93-98,16-94\n8-98,25-97\n41-64,41-42\n5-87,5-6\n12-68,13-67\n24-75,24-75\n41-42,5-41\n16-92,13-49\n16-31,27-96\n27-79,78-78\n32-71,33-72\n23-24,24-96\n4-4,4-78\n85-91,40-91\n6-10,9-75\n38-69,39-69\n8-8,8-74\n7-40,1-7\n33-88,34-88\n32-92,33-92\n7-19,6-64\n21-22,21-22\n7-8,7-99\n4-48,5-47\n27-27,26-61\n77-85,76-86\n22-39,29-40\n4-42,5-63\n85-87,43-79\n8-88,7-9\n55-90,54-90\n7-98,6-8\n6-85,7-84\n18-56,5-19\n54-81,42-50\n7-27,28-40\n96-98,81-97\n52-74,52-53\n61-64,20-63\n45-92,45-60\n18-89,19-89\n9-51,8-52\n19-19,20-95\n49-99,49-99\n17-78,16-16\n20-95,20-21\n11-94,96-99\n38-57,56-58\n94-97,18-90\n38-42,10-53\n67-86,68-86\n2-96,2-91\n33-77,33-89\n25-26,25-51\n86-98,16-97\n2-71,2-71\n28-29,6-28\n30-83,31-84\n13-85,13-84\n23-61,22-48\n32-74,74-92\n41-53,10-94\n15-89,20-90\n25-69,25-25\n1-96,1-96\n7-96,6-96\n1-98,2-2\n47-47,11-48\n35-94,93-95\n67-69,68-77\n43-63,44-64\n14-94,15-49\n7-95,6-96\n15-40,41-41\n8-83,82-90\n66-75,11-67\n40-52,45-51\n20-57,7-20\n4-87,3-87\n97-97,56-95\n45-45,45-45\n58-96,9-95\n33-45,44-44\n6-26,16-26\n46-59,47-60\n24-40,23-40\n6-91,94-98\n40-93,20-84\n32-42,41-42\n2-94,3-93\n59-59,2-60\n7-40,3-7\n47-89,88-88\n35-66,65-67\n84-99,52-85\n75-99,75-96\n8-21,7-8\n3-53,4-52\n22-62,22-62\n72-72,73-78\n39-72,38-96\n2-14,1-91\n4-98,5-76\n8-88,7-13\n5-6,5-99\n20-90,19-90\n26-29,27-34\n52-69,53-95\n56-56,50-57\n23-79,22-79\n16-93,16-78\n13-76,55-92\n36-70,35-70\n43-81,40-80\n4-94,95-99\n1-94,1-94\n48-84,47-49\n32-93,31-92\n11-19,18-77\n62-80,39-74\n62-63,62-96\n3-94,93-95\n15-66,16-66\n23-95,22-88\n57-57,25-58\n71-86,3-72\n2-79,7-78\n47-49,13-48\n46-94,45-45\n19-77,65-76\n31-37,38-87\n4-79,92-99\n17-19,17-19\n1-82,41-89\n47-91,48-49\n6-19,10-37\n14-42,18-39\n40-79,20-61\n2-84,1-31\n83-95,47-84\n68-71,2-69\n37-73,8-72\n85-86,36-85\n2-9,8-78\n17-59,58-68\n62-90,78-90\n77-94,41-93\n11-90,12-94\n34-79,33-97\n42-56,22-57\n38-44,44-45\n1-84,98-98\n63-74,61-73\n28-57,4-58\n48-48,47-90\n37-38,38-77\n72-84,72-72\n3-47,47-47\n50-91,25-59\n5-38,4-38\n24-86,23-55\n55-74,50-75\n33-83,34-83\n1-91,73-88\n13-13,14-85\n54-94,60-99\n21-85,84-86\n12-98,8-36\n89-98,4-90\n4-15,8-15\n98-98,1-99\n21-79,20-78\n2-63,62-63\n78-80,63-79\n24-68,67-86\n24-25,25-47\n53-68,4-55\n11-82,10-82\n23-92,5-99\n94-99,67-88\n11-51,32-86\n49-79,24-48\n22-73,91-99\n4-9,8-89\n23-85,23-54\n5-86,6-13\n13-14,14-94\n72-81,73-82\n56-98,55-98\n3-96,2-96\n88-88,20-89\n78-79,79-85\n29-94,20-30\n8-43,85-90\n96-98,7-71\n45-74,70-71\n23-79,94-94\n41-97,40-97\n73-96,72-72\n4-28,4-65\n89-98,20-90\n37-70,37-98\n26-36,26-35\n41-41,7-42\n7-22,21-90\n12-84,13-75\n98-98,1-99\n47-75,74-87\n7-33,33-90\n41-68,41-87\n64-92,65-88\n41-54,10-42\n6-89,93-96\n20-48,1-21\n8-91,8-8\n11-95,10-97\n72-98,31-90\n44-45,33-44\n54-56,18-55\n7-9,10-88\n44-45,45-90\n52-56,54-83\n68-70,1-69\n91-92,91-92\n13-74,14-75\n4-60,61-91\n9-94,10-95\n9-95,9-10\n50-61,49-68\n50-50,5-51\n38-46,43-43\n4-11,12-22\n42-42,43-96\n77-91,48-76\n23-89,24-94\n9-65,10-15\n53-81,7-73\n8-28,22-37\n76-95,31-77\n9-84,3-84\n12-98,13-99\n17-74,17-78\n60-89,59-89\n1-15,2-14\n14-91,13-88\n87-97,42-96\n77-77,73-76\n16-77,15-69\n80-95,81-96\n40-73,41-90\n47-63,46-62\n5-98,4-97\n46-93,42-92\n15-30,7-23\n7-90,91-95\n1-99,1-2\n5-97,4-99\n81-87,8-28\n56-69,24-68\n87-89,20-88\n78-99,1-98\n32-97,33-97\n19-20,20-33\n77-78,21-78\n2-6,5-42\n35-36,35-44\n2-83,82-84\n48-97,49-58\n36-53,53-75\n5-92,4-93\n49-85,50-86\n45-81,43-82\n3-97,1-43\n97-98,58-97\n6-88,3-88\n4-67,5-66\n43-88,32-44\n95-95,13-96\n4-54,13-97\n1-45,3-45\n2-9,8-98\n1-12,1-53\n13-98,14-84\n85-99,86-99\n4-16,3-16\n15-77,14-15\n18-67,67-68\n34-69,33-70\n97-97,9-92\n76-84,58-77\n76-84,42-55\n96-98,2-97\n50-98,51-72\n54-94,53-94\n23-91,23-91\n21-94,22-95\n41-89,42-89\n48-78,47-78\n18-51,51-76\n5-49,1-34\n40-55,40-47\n41-96,41-97\n8-10,9-94\n74-79,66-80\n6-15,15-91\n10-99,9-99\n12-92,12-96\n32-96,20-33\n5-67,1-66\n21-90,31-94\n22-23,22-60\n")

(defn parse-input [input]
  (->> (str/split input #"\n")
       (map #(str/split % #"[,-]"))
       (map (partial map parse-long))
       (map (partial partition 2))))

(defn part1 []
  (->> (parse-input input)
       (filter (fn [[[a b] [x y]]]
                 (or (and (>= a x) (<= b y))
                     (and (>= x a) (<= y b)))))
       (count)))

(defn part2 []
  (->> (parse-input input)
       (filter (fn [[[a b] [x y]]]
                 (or (<= x a y)
                     (<= x b y)
                     (<= a x b)
                     (<= a y b))))
       (count)))